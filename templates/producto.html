<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Producto {{ item.codigo }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #000;
            color: #fff !important;
            font-family: 'Segoe UI', sans-serif;
        }
        .card {
            background-color: #111;
            border: none;
            border-radius: 25px;
            position: relative; /* Necesario para el pseudo-elemento */
            overflow: hidden;   /* Evita que la imagen se salga del borde redondeado */
        }
        .card::before {
            content: "";
            position: absolute;
            inset: 0;
            background: url('/static/arbol_solo_tumpar.png') no-repeat center;
            background-size: 130%; /* Ajusta el tama침o del 치rbol */
            opacity: 0.09; /* Suave, tipo marca de agua */
            animation: treeGlow 4s ease-in-out infinite;
            z-index: 0; /* Va detr치s del contenido */
        }
        .card * {
            position: relative;
            z-index: 1;
        }       
        .logo {
            max-height: 150px;
        }
        .titulo {
            font-weight: 600;
            font-size: 1.5rem;
            border-bottom: 1px solid #333;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        .promo-banner {
            background: linear-gradient(45deg, #4b0f0f, #7a1f1f); /* rojo vino oscuro */
            color: #ffffff;
            font-weight: 900;
            text-transform: uppercase;
            text-align: center;
            padding: 0.8rem;
            border-radius: 15px;
            margin-bottom: 1.2rem;
            /* Esto mantiene el texto en una sola linea */
            white-space: nowrap;
            /* Hace el ajuste de tama침o autom치ticamente seg칰n pantalla */
            font-size: clamp(0.65rem, 4vw, 1.6rem);
            /*Evita que el texto se salga del banner */
            overflow: hidden;
            text-overflow: ellipsis;
            letter-spacing: 2px;
            border: 2px solid #ffb3b3;
            box-shadow: 0 0 15px rgba(255,179,179,0.6);
            animation: pulseGlow 2s infinite alternate;
        }
        @keyframes pulseGlow {
            from { box-shadow: 0 0 10px rgba(255,179,179,0.4); }
            to   { box-shadow: 0 0 25px rgba(255,255,255,0.9); }
        }
        @keyframes treeGlow {
            0%   { opacity: 0.06; }
            50%  { opacity: 0.10; }
            100% { opacity: 0.06; }
        }
 </style>
</head>
<body>
    <div class="container py-6">
        <div class="text-center mb-7">
            <img src="/static/logo_tumpar.png" alt="Tumpar LTDA" class="logo">
        </div>
        <div class="card p-4 shadow-lg mx-auto" style="max-width: 650px;">
            <div class="titulo text-white">C칩digo: {{ item.codigo }}</div>
            <p class="text-white"><strong>Descripci칩n:</strong> {{ item.descripcion }}</p>
            <p class="text-white"><strong>Marca:</strong> {{ item.marca }}</p>
            <p class="text-white"><strong>Unidad de medida:</strong> {{ item.unidad }}</p>
            <p class="text-white"><strong>Status:</strong> {{ item.status }}</p>
            <p class="text-white"><strong>Detalle:</strong> {{ item.detalle }}</p>

            {% if item.unidad == "CAJA" %}
                <p class="text-white"><strong>Stock Disponible (M2):</strong> {{ item.stock }}</p>
            {% else %}
                <p class="text-white"><strong>Stock Disponible (CAJA):</strong> {{ item.stock }}</p>
            {% endif %}

            <p class="text-white"><strong>칔ltima actualizaci칩n de Precio y Stock:</strong>
                {% if item_stock_fecha_str %}{{ item_stock_fecha_str }}{% else %}N/A{% endif %}
            </p>

            {# ---- NUEVA L칍GICA DE DESCUENTOS Y PROMOS ---- #}
            {% if item.con_descuento == "SI" %}
                
                {% if item.promo == "PROMO DICIEMBRE" %}
                    <div class="promo-banner">游꾻MODO NAVIDE칌O ACTIVADO游꾻</div>
                {% endif %}

                {% if item.unidad == "CAJA" %}
                    <h2><p class="text-white"><strong>Precio Antes M2:</strong> 
                        <span class="text-danger fw-semibold">{{ item.preciom2_antes }} USD</span></p></h2>
                    <h2><p class="text-white"><strong>Precio Actual M2:</strong> 
                        <span class="text-success fw-semibold">{{ item.preciom2 }} USD</span></p></h2>
                {% else %}
                    <h2><p class="text-white"><strong>Precio Antes (UNIDAD):</strong> 
                        <span class="text-danger fw-semibold">{{ item.precio_antes }} USD</span></p></h2>
                    <h2><p class="text-white"><strong>Precio Actual (UNIDAD):</strong> 
                        <span class="text-success fw-semibold">{{ item.precio }} USD</span></p></h2>
                {% endif %}
                
                <h2><p class="text-white"><strong>% de Descuento:</strong> 
                    <span class="text-warning fw-semibold">{{ item.descuento }}</span></p></h2>

            {% else %}
                {% if item.unidad == "CAJA" %}
                    <h2><p class="text-white"><strong>Precio Actual M2:</strong> 
                        <span class="text-success fw-semibold">{{ item.preciom2 }} USD</span></p></h2>
                {% else %}
                    <h2><p class="text-white"><strong>Precio Actual (UNIDAD):</strong> 
                        <span class="text-success fw-semibold">{{ item.precio }} USD</span></p></h2>
                {% endif %}
            {% endif %}
        </div>
    </div>   
</body>
</html>
